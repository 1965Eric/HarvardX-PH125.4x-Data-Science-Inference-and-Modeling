<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Section 7 Overview | Data Science Inference and Modeling</title>
  <meta name="description" content="8 Section 7 Overview | Data Science Inference and Modeling" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Section 7 Overview | Data Science Inference and Modeling" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Section 7 Overview | Data Science Inference and Modeling" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-6-overview.html"/>

<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning Objectives</a>
<ul>
<li class="chapter" data-level="1.1" data-path="learning-objectives.html"><a href="learning-objectives.html#course-overview"><i class="fa fa-check"></i><b>1.1</b> Course Overview</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="learning-objectives.html"><a href="learning-objectives.html#section-1-parameters-and-estimates"><i class="fa fa-check"></i><b>1.1.1</b> Section 1: Parameters and Estimates</a></li>
<li class="chapter" data-level="1.1.2" data-path="learning-objectives.html"><a href="learning-objectives.html#section-2-the-central-limit-theorem-in-practice"><i class="fa fa-check"></i><b>1.1.2</b> Section 2: The Central Limit Theorem in Practice</a></li>
<li class="chapter" data-level="1.1.3" data-path="learning-objectives.html"><a href="learning-objectives.html#section-3-confidence-intervals-and-p-values"><i class="fa fa-check"></i><b>1.1.3</b> Section 3: Confidence Intervals and p-Values</a></li>
<li class="chapter" data-level="1.1.4" data-path="learning-objectives.html"><a href="learning-objectives.html#section-4-statistical-models"><i class="fa fa-check"></i><b>1.1.4</b> Section 4: Statistical Models</a></li>
<li class="chapter" data-level="1.1.5" data-path="learning-objectives.html"><a href="learning-objectives.html#section-5-bayesian-statistics"><i class="fa fa-check"></i><b>1.1.5</b> Section 5: Bayesian Statistics</a></li>
<li class="chapter" data-level="1.1.6" data-path="learning-objectives.html"><a href="learning-objectives.html#section-6-election-forecasting"><i class="fa fa-check"></i><b>1.1.6</b> Section 6: Election Forecasting</a></li>
<li class="chapter" data-level="1.1.7" data-path="learning-objectives.html"><a href="learning-objectives.html#section-7-association-tests"><i class="fa fa-check"></i><b>1.1.7</b> Section 7: Association Tests</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="learning-objectives.html"><a href="learning-objectives.html#introduction-to-inference"><i class="fa fa-check"></i><b>1.2</b> Introduction to Inference</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="section-1-overview.html"><a href="section-1-overview.html"><i class="fa fa-check"></i><b>2</b> Section 1 Overview</a>
<ul>
<li class="chapter" data-level="2.1" data-path="section-1-overview.html"><a href="section-1-overview.html#sampling-model-parameters-and-estimates"><i class="fa fa-check"></i><b>2.1</b> Sampling Model Parameters and Estimates</a></li>
<li class="chapter" data-level="2.2" data-path="section-1-overview.html"><a href="section-1-overview.html#the-sample-average"><i class="fa fa-check"></i><b>2.2</b> The Sample Average</a></li>
<li class="chapter" data-level="2.3" data-path="section-1-overview.html"><a href="section-1-overview.html#polling-versus-forecasting"><i class="fa fa-check"></i><b>2.3</b> Polling versus Forecasting</a></li>
<li class="chapter" data-level="2.4" data-path="section-1-overview.html"><a href="section-1-overview.html#properties-of-our-estimate"><i class="fa fa-check"></i><b>2.4</b> Properties of Our Estimate</a></li>
<li class="chapter" data-level="2.5" data-path="section-1-overview.html"><a href="section-1-overview.html#assessment---parameters-and-estimates"><i class="fa fa-check"></i><b>2.5</b> Assessment - Parameters and Estimates</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-2-overview.html"><a href="section-2-overview.html"><i class="fa fa-check"></i><b>3</b> Section 2 Overview</a>
<ul>
<li class="chapter" data-level="3.1" data-path="section-2-overview.html"><a href="section-2-overview.html#the-central-limit-theorem-in-practice"><i class="fa fa-check"></i><b>3.1</b> The Central Limit Theorem in Practice</a></li>
<li class="chapter" data-level="3.2" data-path="section-2-overview.html"><a href="section-2-overview.html#margin-of-error"><i class="fa fa-check"></i><b>3.2</b> Margin of Error</a></li>
<li class="chapter" data-level="3.3" data-path="section-2-overview.html"><a href="section-2-overview.html#a-monte-carlo-simulation-for-the-clt"><i class="fa fa-check"></i><b>3.3</b> A Monte Carlo Simulation for the CLT</a></li>
<li class="chapter" data-level="3.4" data-path="section-2-overview.html"><a href="section-2-overview.html#the-spread"><i class="fa fa-check"></i><b>3.4</b> The Spread</a></li>
<li class="chapter" data-level="3.5" data-path="section-2-overview.html"><a href="section-2-overview.html#bias-why-not-run-a-very-large-poll"><i class="fa fa-check"></i><b>3.5</b> Bias: Why Not Run a Very Large Poll?</a></li>
<li class="chapter" data-level="3.6" data-path="section-2-overview.html"><a href="section-2-overview.html#assessment---introduction-to-inference"><i class="fa fa-check"></i><b>3.6</b> Assessment - Introduction to Inference</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-3-overview.html"><a href="section-3-overview.html"><i class="fa fa-check"></i><b>4</b> Section 3 Overview</a>
<ul>
<li class="chapter" data-level="4.1" data-path="section-3-overview.html"><a href="section-3-overview.html#confidence-intervals"><i class="fa fa-check"></i><b>4.1</b> Confidence Intervals</a></li>
<li class="chapter" data-level="4.2" data-path="section-3-overview.html"><a href="section-3-overview.html#a-monte-carlo-simulation-for-confidence-intervals"><i class="fa fa-check"></i><b>4.2</b> A Monte Carlo Simulation for Confidence Intervals</a></li>
<li class="chapter" data-level="4.3" data-path="section-3-overview.html"><a href="section-3-overview.html#the-correct-language"><i class="fa fa-check"></i><b>4.3</b> The Correct Language</a></li>
<li class="chapter" data-level="4.4" data-path="section-3-overview.html"><a href="section-3-overview.html#power"><i class="fa fa-check"></i><b>4.4</b> Power</a></li>
<li class="chapter" data-level="4.5" data-path="section-3-overview.html"><a href="section-3-overview.html#p-values"><i class="fa fa-check"></i><b>4.5</b> p-Values</a></li>
<li class="chapter" data-level="4.6" data-path="section-3-overview.html"><a href="section-3-overview.html#another-explanation-of-p-values"><i class="fa fa-check"></i><b>4.6</b> Another Explanation of p-Values</a></li>
<li class="chapter" data-level="4.7" data-path="section-3-overview.html"><a href="section-3-overview.html#assessment---confidence-intervals-and-p-values"><i class="fa fa-check"></i><b>4.7</b> Assessment - Confidence Intervals and p-Values</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="section-4-overview.html"><a href="section-4-overview.html"><i class="fa fa-check"></i><b>5</b> Section 4 Overview</a>
<ul>
<li class="chapter" data-level="5.1" data-path="section-4-overview.html"><a href="section-4-overview.html#poll-aggregators"><i class="fa fa-check"></i><b>5.1</b> Poll Aggregators</a></li>
<li class="chapter" data-level="5.2" data-path="section-4-overview.html"><a href="section-4-overview.html#pollsters-and-multilevel-models"><i class="fa fa-check"></i><b>5.2</b> Pollsters and Multilevel Models</a></li>
<li class="chapter" data-level="5.3" data-path="section-4-overview.html"><a href="section-4-overview.html#poll-data-and-pollster-bias"><i class="fa fa-check"></i><b>5.3</b> Poll Data and Pollster Bias</a></li>
<li class="chapter" data-level="5.4" data-path="section-4-overview.html"><a href="section-4-overview.html#data-driven-models"><i class="fa fa-check"></i><b>5.4</b> Data-Driven Models</a></li>
<li class="chapter" data-level="5.5" data-path="section-4-overview.html"><a href="section-4-overview.html#assessment---statistical-models"><i class="fa fa-check"></i><b>5.5</b> Assessment - Statistical Models</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="section-5-overview.html"><a href="section-5-overview.html"><i class="fa fa-check"></i><b>6</b> Section 5 Overview</a>
<ul>
<li class="chapter" data-level="6.1" data-path="section-5-overview.html"><a href="section-5-overview.html#bayesian-statistics"><i class="fa fa-check"></i><b>6.1</b> Bayesian Statistics</a></li>
<li class="chapter" data-level="6.2" data-path="section-5-overview.html"><a href="section-5-overview.html#bayes-theorem"><i class="fa fa-check"></i><b>6.2</b> Bayes’ Theorem</a></li>
<li class="chapter" data-level="6.3" data-path="section-5-overview.html"><a href="section-5-overview.html#bayes-in-practice"><i class="fa fa-check"></i><b>6.3</b> Bayes in Practice</a></li>
<li class="chapter" data-level="6.4" data-path="section-5-overview.html"><a href="section-5-overview.html#the-hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> The Hierarchical Model</a></li>
<li class="chapter" data-level="6.5" data-path="section-5-overview.html"><a href="section-5-overview.html#assessment---bayesian-statistics"><i class="fa fa-check"></i><b>6.5</b> Assessment - Bayesian Statistics</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="section-6-overview.html"><a href="section-6-overview.html"><i class="fa fa-check"></i><b>7</b> Section 6 Overview</a>
<ul>
<li class="chapter" data-level="7.1" data-path="section-6-overview.html"><a href="section-6-overview.html#election-forecasting"><i class="fa fa-check"></i><b>7.1</b> Election Forecasting</a></li>
<li class="chapter" data-level="7.2" data-path="section-6-overview.html"><a href="section-6-overview.html#mathematical-representations-of-models"><i class="fa fa-check"></i><b>7.2</b> Mathematical Representations of Models</a></li>
<li class="chapter" data-level="7.3" data-path="section-6-overview.html"><a href="section-6-overview.html#predicting-the-electoral-college"><i class="fa fa-check"></i><b>7.3</b> Predicting the Electoral College</a></li>
<li class="chapter" data-level="7.4" data-path="section-6-overview.html"><a href="section-6-overview.html#forecasting"><i class="fa fa-check"></i><b>7.4</b> Forecasting</a></li>
<li class="chapter" data-level="7.5" data-path="section-6-overview.html"><a href="section-6-overview.html#assessment---election-forecasting"><i class="fa fa-check"></i><b>7.5</b> Assessment - Election Forecasting</a></li>
<li class="chapter" data-level="7.6" data-path="section-6-overview.html"><a href="section-6-overview.html#the-t-distribution"><i class="fa fa-check"></i><b>7.6</b> The t-Distribution</a></li>
<li class="chapter" data-level="7.7" data-path="section-6-overview.html"><a href="section-6-overview.html#assessment---the-t-distribution"><i class="fa fa-check"></i><b>7.7</b> Assessment - The t-Distribution</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="section-7-overview.html"><a href="section-7-overview.html"><i class="fa fa-check"></i><b>8</b> Section 7 Overview</a>
<ul>
<li class="chapter" data-level="8.1" data-path="section-7-overview.html"><a href="section-7-overview.html#association-tests"><i class="fa fa-check"></i><b>8.1</b> Association Tests</a></li>
<li class="chapter" data-level="8.2" data-path="section-7-overview.html"><a href="section-7-overview.html#chi-squared-tests"><i class="fa fa-check"></i><b>8.2</b> Chi-Squared Tests</a></li>
<li class="chapter" data-level="8.3" data-path="section-7-overview.html"><a href="section-7-overview.html#assessment---association-and-chi-squared-tests"><i class="fa fa-check"></i><b>8.3</b> Assessment - Association and Chi-Squared Tests</a></li>
<li class="chapter" data-level="8.4" data-path="section-7-overview.html"><a href="section-7-overview.html#comprehensive-assessment-brexit"><i class="fa fa-check"></i><b>8.4</b> Comprehensive Assessment: Brexit</a></li>
<li class="chapter" data-level="8.5" data-path="section-7-overview.html"><a href="section-7-overview.html#brexit-poll-analysis---part-1"><i class="fa fa-check"></i><b>8.5</b> Brexit poll analysis - Part 1</a></li>
<li class="chapter" data-level="8.6" data-path="section-7-overview.html"><a href="section-7-overview.html#brexit-poll-analysis---part-2"><i class="fa fa-check"></i><b>8.6</b> Brexit poll analysis - Part 2</a></li>
<li class="chapter" data-level="8.7" data-path="section-7-overview.html"><a href="section-7-overview.html#brexit-poll-analysis---part-3"><i class="fa fa-check"></i><b>8.7</b> Brexit poll analysis - Part 3</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science Inference and Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-7-overview" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Section 7 Overview</h1>
<p>In Section 7, you will learn how to use association and chi-squared tests to perform inference for binary, categorical, and ordinal data through an example looking at research funding rates.</p>
<p>After completing Section 7, you will be able to:</p>
<ul>
<li>Use association and chi-squared tests to perform inference on binary, categorical, and ordinal data.</li>
<li>Calculate an odds ratio to get an idea of the magnitude of an observed effect.</li>
</ul>
<div id="association-tests" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Association Tests</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/inference.html#association-tests" target="_blank">here</a> up to and including the <a href="https://rafalab.github.io/dsbook/inference.html#two-by-two-tables" target="_blank">textbook section</a> on two-by-two tables.</p>
<p><strong>Key points</strong></p>
<ul>
<li>We learn how to determine the probability that an observation is due to random variability given categorical, binary or ordinal data.</li>
<li>Fisher’s exact test determines the p-value as the probability of observing an outcome as extreme or more extreme than the observed outcome given the null distribution.</li>
<li>Data from a binary experiment are often summarized in <em>two-by-two tables</em>.</li>
<li>The p-value can be calculated from a two-by-two table using Fisher’s exact test with the function <code>fisher.test()</code>.</li>
</ul>
<p><em>Code: Research funding rates example</em></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="section-7-overview.html#cb274-1" aria-hidden="true"></a><span class="co"># load and inspect research funding rates object</span></span>
<span id="cb274-2"><a href="section-7-overview.html#cb274-2" aria-hidden="true"></a><span class="kw">data</span>(research_funding_rates)</span>
<span id="cb274-3"><a href="section-7-overview.html#cb274-3" aria-hidden="true"></a>research_funding_rates</span></code></pre></div>
<pre><code>##            discipline applications_total applications_men applications_women awards_total awards_men awards_women success_rates_total success_rates_men success_rates_women
## 1   Chemical sciences                122               83                 39           32         22           10                26.2              26.5                25.6
## 2   Physical sciences                174              135                 39           35         26            9                20.1              19.3                23.1
## 3             Physics                 76               67                  9           20         18            2                26.3              26.9                22.2
## 4          Humanities                396              230                166           65         33           32                16.4              14.3                19.3
## 5  Technical sciences                251              189                 62           43         30           13                17.1              15.9                21.0
## 6   Interdisciplinary                183              105                 78           29         12           17                15.8              11.4                21.8
## 7 Earth/life sciences                282              156                126           56         38           18                19.9              24.4                14.3
## 8     Social sciences                834              425                409          112         65           47                13.4              15.3                11.5
## 9    Medical sciences                505              245                260           75         46           29                14.9              18.8                11.2</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="section-7-overview.html#cb276-1" aria-hidden="true"></a><span class="co"># compute totals that were successful or not successful</span></span>
<span id="cb276-2"><a href="section-7-overview.html#cb276-2" aria-hidden="true"></a>totals &lt;-<span class="st"> </span>research_funding_rates <span class="op">%&gt;%</span></span>
<span id="cb276-3"><a href="section-7-overview.html#cb276-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>discipline) <span class="op">%&gt;%</span></span>
<span id="cb276-4"><a href="section-7-overview.html#cb276-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarize_all</span>(<span class="kw">funs</span>(sum)) <span class="op">%&gt;%</span></span>
<span id="cb276-5"><a href="section-7-overview.html#cb276-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">yes_men =</span> awards_men,</span>
<span id="cb276-6"><a href="section-7-overview.html#cb276-6" aria-hidden="true"></a>                         <span class="dt">no_men =</span> applications_men <span class="op">-</span><span class="st"> </span>awards_men,</span>
<span id="cb276-7"><a href="section-7-overview.html#cb276-7" aria-hidden="true"></a>                         <span class="dt">yes_women =</span> awards_women,</span>
<span id="cb276-8"><a href="section-7-overview.html#cb276-8" aria-hidden="true"></a>                         <span class="dt">no_women =</span> applications_women <span class="op">-</span><span class="st"> </span>awards_women)</span></code></pre></div>
<pre><code>## Warning: `funs()` is deprecated as of dplyr 0.8.0.
## Please use a list of either functions or lambdas: 
## 
##   # Simple named list: 
##   list(mean = mean, median = median)
## 
##   # Auto named with `tibble::lst()`: 
##   tibble::lst(mean, median)
## 
##   # Using lambdas
##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="section-7-overview.html#cb278-1" aria-hidden="true"></a><span class="co"># compare percentage of men/women with awards</span></span>
<span id="cb278-2"><a href="section-7-overview.html#cb278-2" aria-hidden="true"></a>totals <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">percent_men =</span> yes_men<span class="op">/</span>(yes_men <span class="op">+</span><span class="st"> </span>no_men),</span>
<span id="cb278-3"><a href="section-7-overview.html#cb278-3" aria-hidden="true"></a>                                          <span class="dt">percent_women =</span> yes_women<span class="op">/</span>(yes_women <span class="op">+</span><span class="st"> </span>no_women))</span></code></pre></div>
<pre><code>##   percent_men percent_women
## 1     0.17737     0.1489899</code></pre>
<p><em>Code: Two-by-two table and p-value for the Lady Tasting Tea problem</em></p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="section-7-overview.html#cb280-1" aria-hidden="true"></a>tab &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb280-2"><a href="section-7-overview.html#cb280-2" aria-hidden="true"></a><span class="kw">rownames</span>(tab) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Poured Before&quot;</span>, <span class="st">&quot;Poured After&quot;</span>)</span>
<span id="cb280-3"><a href="section-7-overview.html#cb280-3" aria-hidden="true"></a><span class="kw">colnames</span>(tab) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Guessed Before&quot;</span>, <span class="st">&quot;Guessed After&quot;</span>)</span>
<span id="cb280-4"><a href="section-7-overview.html#cb280-4" aria-hidden="true"></a>tab</span></code></pre></div>
<pre><code>##               Guessed Before Guessed After
## Poured Before              3             1
## Poured After               1             3</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="section-7-overview.html#cb282-1" aria-hidden="true"></a><span class="co"># p-value calculation with Fisher&#39;s Exact Test</span></span>
<span id="cb282-2"><a href="section-7-overview.html#cb282-2" aria-hidden="true"></a><span class="kw">fisher.test</span>(tab, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  tab
## p-value = 0.2429
## alternative hypothesis: true odds ratio is greater than 1
## 95 percent confidence interval:
##  0.3135693       Inf
## sample estimates:
## odds ratio 
##   6.408309</code></pre>
</div>
<div id="chi-squared-tests" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Chi-Squared Tests</h2>
<p>The textbook for this section is available <a href="https://rafalab.github.io/dsbook/inference.html#chi-square-test" target="_blank">here</a> and <a href="https://rafalab.github.io/dsbook/inference.html#odds-ratio" target="_blank">here</a>.</p>
<p><strong>Key points</strong></p>
<ul>
<li>If the sums of the rows and the sums of the columns in the two-by-two table are fixed, then the hypergeometric distribution and Fisher’s exact test can be used. Otherwise, we must use the chi-squared test.</li>
<li>The <em>chi-squared test</em> compares the observed two-by-two table to the two-by-two table expected by the null hypothesis and asks how likely it is that we see a deviation as large as observed or larger by chance.</li>
<li>The function <code>chisq.test()</code> takes a two-by-two table and returns the p-value from the chi-squared test.</li>
<li>The <em>odds ratio</em> states how many times larger the odds of an outcome are for one group relative to another group.</li>
<li>A small p-value does not imply a large odds ratio. If a finding has a small p-value but also a small odds ratio, it may not be a practically significant or scientifically significant finding.</li>
<li>Because the odds ratio is a ratio of ratios, there is no simple way to use the Central Limit Theorem to compute confidence intervals. There are advanced methods for computing confidence intervals for odds ratios that we do not discuss here.</li>
</ul>
<p><em>Code: Chi-squared test</em></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="section-7-overview.html#cb284-1" aria-hidden="true"></a><span class="co"># compute overall funding rate</span></span>
<span id="cb284-2"><a href="section-7-overview.html#cb284-2" aria-hidden="true"></a>funding_rate &lt;-<span class="st"> </span>totals <span class="op">%&gt;%</span></span>
<span id="cb284-3"><a href="section-7-overview.html#cb284-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">percent_total =</span> (yes_men <span class="op">+</span><span class="st"> </span>yes_women) <span class="op">/</span><span class="st"> </span>(yes_men <span class="op">+</span><span class="st"> </span>no_men <span class="op">+</span><span class="st"> </span>yes_women <span class="op">+</span><span class="st"> </span>no_women)) <span class="op">%&gt;%</span></span>
<span id="cb284-4"><a href="section-7-overview.html#cb284-4" aria-hidden="true"></a><span class="st">    </span>.<span class="op">$</span>percent_total</span>
<span id="cb284-5"><a href="section-7-overview.html#cb284-5" aria-hidden="true"></a>funding_rate</span></code></pre></div>
<pre><code>## [1] 0.1654269</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="section-7-overview.html#cb286-1" aria-hidden="true"></a><span class="co"># construct two-by-two table for observed data</span></span>
<span id="cb286-2"><a href="section-7-overview.html#cb286-2" aria-hidden="true"></a>two_by_two &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">awarded =</span> <span class="kw">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>),</span>
<span id="cb286-3"><a href="section-7-overview.html#cb286-3" aria-hidden="true"></a>                    <span class="dt">men =</span> <span class="kw">c</span>(totals<span class="op">$</span>no_men, totals<span class="op">$</span>yes_men),</span>
<span id="cb286-4"><a href="section-7-overview.html#cb286-4" aria-hidden="true"></a>                     <span class="dt">women =</span> <span class="kw">c</span>(totals<span class="op">$</span>no_women, totals<span class="op">$</span>yes_women))</span>
<span id="cb286-5"><a href="section-7-overview.html#cb286-5" aria-hidden="true"></a>two_by_two</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   awarded   men women
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 no       1345  1011
## 2 yes       290   177</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="section-7-overview.html#cb288-1" aria-hidden="true"></a><span class="co"># compute null hypothesis two-by-two table</span></span>
<span id="cb288-2"><a href="section-7-overview.html#cb288-2" aria-hidden="true"></a><span class="kw">tibble</span>(<span class="dt">awarded =</span> <span class="kw">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>),</span>
<span id="cb288-3"><a href="section-7-overview.html#cb288-3" aria-hidden="true"></a>           <span class="dt">men =</span> (totals<span class="op">$</span>no_men <span class="op">+</span><span class="st"> </span>totals<span class="op">$</span>yes_men) <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>funding_rate, funding_rate),</span>
<span id="cb288-4"><a href="section-7-overview.html#cb288-4" aria-hidden="true"></a>           <span class="dt">women =</span> (totals<span class="op">$</span>no_women <span class="op">+</span><span class="st"> </span>totals<span class="op">$</span>yes_women) <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>funding_rate, funding_rate))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   awarded   men women
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 no      1365.  991.
## 2 yes      270.  197.</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="section-7-overview.html#cb290-1" aria-hidden="true"></a><span class="co"># chi-squared test</span></span>
<span id="cb290-2"><a href="section-7-overview.html#cb290-2" aria-hidden="true"></a>chisq_test &lt;-<span class="st"> </span>two_by_two <span class="op">%&gt;%</span></span>
<span id="cb290-3"><a href="section-7-overview.html#cb290-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>awarded) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">chisq.test</span>()</span>
<span id="cb290-4"><a href="section-7-overview.html#cb290-4" aria-hidden="true"></a>chisq_test<span class="op">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.05091372</code></pre>
<p><em>Code: Odds ratio</em></p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="section-7-overview.html#cb292-1" aria-hidden="true"></a><span class="co"># odds of getting funding for men</span></span>
<span id="cb292-2"><a href="section-7-overview.html#cb292-2" aria-hidden="true"></a>odds_men &lt;-<span class="st"> </span>(two_by_two<span class="op">$</span>men[<span class="dv">2</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(two_by_two<span class="op">$</span>men)) <span class="op">/</span></span>
<span id="cb292-3"><a href="section-7-overview.html#cb292-3" aria-hidden="true"></a><span class="st">        </span>(two_by_two<span class="op">$</span>men[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(two_by_two<span class="op">$</span>men))</span>
<span id="cb292-4"><a href="section-7-overview.html#cb292-4" aria-hidden="true"></a></span>
<span id="cb292-5"><a href="section-7-overview.html#cb292-5" aria-hidden="true"></a><span class="co"># odds of getting funding for women</span></span>
<span id="cb292-6"><a href="section-7-overview.html#cb292-6" aria-hidden="true"></a>odds_women &lt;-<span class="st"> </span>(two_by_two<span class="op">$</span>women[<span class="dv">2</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(two_by_two<span class="op">$</span>women)) <span class="op">/</span></span>
<span id="cb292-7"><a href="section-7-overview.html#cb292-7" aria-hidden="true"></a><span class="st">        </span>(two_by_two<span class="op">$</span>women[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(two_by_two<span class="op">$</span>women))</span>
<span id="cb292-8"><a href="section-7-overview.html#cb292-8" aria-hidden="true"></a></span>
<span id="cb292-9"><a href="section-7-overview.html#cb292-9" aria-hidden="true"></a><span class="co"># odds ratio - how many times larger odds are for men than women</span></span>
<span id="cb292-10"><a href="section-7-overview.html#cb292-10" aria-hidden="true"></a>odds_men<span class="op">/</span>odds_women</span></code></pre></div>
<pre><code>## [1] 1.231554</code></pre>
<p>Code: p-value and odds ratio responses to increasing sample size</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="section-7-overview.html#cb294-1" aria-hidden="true"></a><span class="co"># multiplying all observations by 10 decreases p-value without changing odds ratio</span></span>
<span id="cb294-2"><a href="section-7-overview.html#cb294-2" aria-hidden="true"></a>two_by_two <span class="op">%&gt;%</span></span>
<span id="cb294-3"><a href="section-7-overview.html#cb294-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>awarded) <span class="op">%&gt;%</span></span>
<span id="cb294-4"><a href="section-7-overview.html#cb294-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">men =</span> men<span class="op">*</span><span class="dv">10</span>, <span class="dt">women =</span> women<span class="op">*</span><span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb294-5"><a href="section-7-overview.html#cb294-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">chisq.test</span>()</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  .
## X-squared = 39.935, df = 1, p-value = 2.625e-10</code></pre>
</div>
<div id="assessment---association-and-chi-squared-tests" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Assessment - Association and Chi-Squared Tests</h2>
<ol style="list-style-type: decimal">
<li>In a previous exercise, we determined whether or not each poll predicted the correct winner for their state in the 2016 U.S. presidential election.</li>
</ol>
<p>Each poll was also assigned a grade by the poll aggregator. Now we’re going to determine if polls rated A- made better predictions than polls rated C-.</p>
<p>In this exercise, filter the errors data for just polls with grades A- and C-. Calculate the proportion of times each grade of poll predicted the correct winner.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="section-7-overview.html#cb296-1" aria-hidden="true"></a><span class="co"># The &#39;errors&#39; data have already been loaded. Examine them using the `head` function.</span></span>
<span id="cb296-2"><a href="section-7-overview.html#cb296-2" aria-hidden="true"></a><span class="kw">head</span>(errors)</span></code></pre></div>
<pre><code>##            state  startdate    enddate                pollster grade spread        lower         upper  error   hit
## 1     New Mexico 2016-11-06 2016-11-06                Zia Poll  &lt;NA&gt;   0.02 -0.001331221  0.0413312213 -0.063  TRUE
## 2       Virginia 2016-11-03 2016-11-04   Public Policy Polling    B+   0.05 -0.005634504  0.1056345040 -0.004  TRUE
## 3           Iowa 2016-11-01 2016-11-04        Selzer &amp; Company    A+  -0.07 -0.139125210 -0.0008747905  0.024  TRUE
## 4      Wisconsin 2016-10-26 2016-10-31    Marquette University     A   0.06  0.004774064  0.1152259363  0.067 FALSE
## 5 North Carolina 2016-11-04 2016-11-06           Siena College     A   0.00 -0.069295191  0.0692951912  0.036 FALSE
## 6        Georgia 2016-11-06 2016-11-06 Landmark Communications     B  -0.03 -0.086553820  0.0265538203  0.021  TRUE</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="section-7-overview.html#cb298-1" aria-hidden="true"></a><span class="co"># Generate an object called &#39;totals&#39; that contains the numbers of good and bad predictions for polls rated A- and C-</span></span>
<span id="cb298-2"><a href="section-7-overview.html#cb298-2" aria-hidden="true"></a>totals &lt;-<span class="st"> </span>errors <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(grade <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A-&quot;</span>, <span class="st">&quot;C-&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb298-3"><a href="section-7-overview.html#cb298-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(grade,hit) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">num =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>(grade, num)</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;grade&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="section-7-overview.html#cb300-1" aria-hidden="true"></a>totals</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   hit    `C-`  `A-`
##   &lt;lgl&gt; &lt;int&gt; &lt;int&gt;
## 1 FALSE    50    26
## 2 TRUE    311   106</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="section-7-overview.html#cb302-1" aria-hidden="true"></a><span class="co"># Print the proportion of hits for grade A- polls to the console</span></span>
<span id="cb302-2"><a href="section-7-overview.html#cb302-2" aria-hidden="true"></a>p_hitA &lt;-<span class="st"> </span>totals[[<span class="dv">2</span>,<span class="dv">3</span>]]<span class="op">/</span><span class="kw">sum</span>(totals[[<span class="dv">3</span>]])</span>
<span id="cb302-3"><a href="section-7-overview.html#cb302-3" aria-hidden="true"></a>p_hitA</span></code></pre></div>
<pre><code>## [1] 0.8030303</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="section-7-overview.html#cb304-1" aria-hidden="true"></a><span class="co"># Print the proportion of hits for grade C- polls to the console</span></span>
<span id="cb304-2"><a href="section-7-overview.html#cb304-2" aria-hidden="true"></a>p_hitC &lt;-<span class="st"> </span>totals[[<span class="dv">2</span>,<span class="dv">2</span>]]<span class="op">/</span><span class="kw">sum</span>(totals[[<span class="dv">2</span>]])</span>
<span id="cb304-3"><a href="section-7-overview.html#cb304-3" aria-hidden="true"></a>p_hitC</span></code></pre></div>
<pre><code>## [1] 0.8614958</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>We found that the A- polls predicted the correct winner about 80% of the time in their states and C- polls predicted the correct winner about 86% of the time.</li>
</ol>
<p>Use a chi-squared test to determine if these proportions are different.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="section-7-overview.html#cb306-1" aria-hidden="true"></a><span class="co"># The &#39;totals&#39; data have already been loaded. Examine them using the `head` function.</span></span>
<span id="cb306-2"><a href="section-7-overview.html#cb306-2" aria-hidden="true"></a><span class="kw">head</span>(totals)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   hit    `C-`  `A-`
##   &lt;lgl&gt; &lt;int&gt; &lt;int&gt;
## 1 FALSE    50    26
## 2 TRUE    311   106</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="section-7-overview.html#cb308-1" aria-hidden="true"></a><span class="co"># Perform a chi-squared test on the hit data. Save the results as an object called &#39;chisq_test&#39;.</span></span>
<span id="cb308-2"><a href="section-7-overview.html#cb308-2" aria-hidden="true"></a>chisq_test &lt;-<span class="st"> </span>totals <span class="op">%&gt;%</span></span>
<span id="cb308-3"><a href="section-7-overview.html#cb308-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>hit) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">chisq.test</span>()</span>
<span id="cb308-4"><a href="section-7-overview.html#cb308-4" aria-hidden="true"></a></span>
<span id="cb308-5"><a href="section-7-overview.html#cb308-5" aria-hidden="true"></a><span class="co"># Print the p-value of the chi-squared test to the console</span></span>
<span id="cb308-6"><a href="section-7-overview.html#cb308-6" aria-hidden="true"></a>chisq_test<span class="op">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.1467902</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>It doesn’t look like the grade A- polls performed significantly differently than the grade C- polls in their states.</li>
</ol>
<p>Calculate the odds ratio to determine the magnitude of the difference in performance between these two grades of polls.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="section-7-overview.html#cb310-1" aria-hidden="true"></a><span class="co"># The &#39;totals&#39; data have already been loaded. Examine them using the `head` function.</span></span>
<span id="cb310-2"><a href="section-7-overview.html#cb310-2" aria-hidden="true"></a><span class="kw">head</span>(totals)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   hit    `C-`  `A-`
##   &lt;lgl&gt; &lt;int&gt; &lt;int&gt;
## 1 FALSE    50    26
## 2 TRUE    311   106</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="section-7-overview.html#cb312-1" aria-hidden="true"></a><span class="co"># Generate a variable called `odds_C` that contains the odds of getting the prediction right for grade C- polls</span></span>
<span id="cb312-2"><a href="section-7-overview.html#cb312-2" aria-hidden="true"></a>odds_C &lt;-<span class="st"> </span>(totals[[<span class="dv">2</span>,<span class="dv">2</span>]] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(totals[[<span class="dv">2</span>]])) <span class="op">/</span><span class="st"> </span></span>
<span id="cb312-3"><a href="section-7-overview.html#cb312-3" aria-hidden="true"></a><span class="st">  </span>(totals[[<span class="dv">1</span>,<span class="dv">2</span>]] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(totals[[<span class="dv">2</span>]]))</span>
<span id="cb312-4"><a href="section-7-overview.html#cb312-4" aria-hidden="true"></a></span>
<span id="cb312-5"><a href="section-7-overview.html#cb312-5" aria-hidden="true"></a><span class="co"># Generate a variable called `odds_A` that contains the odds of getting the prediction right for grade A- polls</span></span>
<span id="cb312-6"><a href="section-7-overview.html#cb312-6" aria-hidden="true"></a>odds_A &lt;-<span class="st"> </span>(totals[[<span class="dv">2</span>,<span class="dv">3</span>]] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(totals[[<span class="dv">3</span>]])) <span class="op">/</span></span>
<span id="cb312-7"><a href="section-7-overview.html#cb312-7" aria-hidden="true"></a><span class="st">        </span>(totals[[<span class="dv">1</span>,<span class="dv">3</span>]] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(totals[[<span class="dv">3</span>]]))</span>
<span id="cb312-8"><a href="section-7-overview.html#cb312-8" aria-hidden="true"></a></span>
<span id="cb312-9"><a href="section-7-overview.html#cb312-9" aria-hidden="true"></a><span class="co"># Calculate the odds ratio to determine how many times larger the odds ratio is for grade A- polls than grade C- polls</span></span>
<span id="cb312-10"><a href="section-7-overview.html#cb312-10" aria-hidden="true"></a>odds_A<span class="op">/</span>odds_C</span></code></pre></div>
<pre><code>## [1] 0.6554539</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>We did not find meaningful differences between the poll results from grade A- and grade C- polls in this subset of the data, which only contains polls for about a week before the election.</li>
</ol>
<p>Imagine we expanded our analysis to include all election polls and we repeat our analysis. In this hypothetical scenario, we get that the p-value for the difference in prediction success if 0.0015 and the odds ratio describing the effect size of the performance of grade A- over grade B- polls is 1.07.</p>
<p>Based on what we learned in the last section, which statement reflects the best interpretation of this result?</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. The p-value is below 0.05, so there is a significant difference. Grade A- polls are significantly better at predicting winners.</li>
<li><input type="checkbox" disabled="" />
B. The p-value is too close to 0.05 to call this a significant difference. We do not observe a difference in performance.</li>
<li><input type="checkbox" disabled="" checked="" />
C. The p-value is below 0.05, but the odds ratio is very close to 1. There is not a scientifically significant difference in performance.</li>
<li><input type="checkbox" disabled="" />
D. The p-value is below 0.05 and the odds ratio indicates that grade A- polls perform significantly better than grade C- polls.</li>
</ul>
</div>
<div id="comprehensive-assessment-brexit" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Comprehensive Assessment: Brexit</h2>
</div>
<div id="brexit-poll-analysis---part-1" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Brexit poll analysis - Part 1</h2>
<p><strong>Directions</strong></p>
<p>There are 12 multi-part problems in this comprehensive assessment that review concepts from the entire course. The problems are split over 3 pages. Make sure you read the instructions carefully and run all pre-exercise code.</p>
<p>For numeric entry problems, you have 10 attempts to input the correct answer. For true/false problems, you have 2 attempts.</p>
<p>If you have questions, visit the “Brexit poll analysis” discussion forum that follows the assessment.</p>
<p><em>IMPORTANT</em>: Some of these exercises use <strong>dslabs</strong> datasets that were added in a July 2019 update. Make sure your package is up to date with the command <code>install.packages("dslabs")</code>.</p>
<p><strong>Overview</strong></p>
<p>In June 2016, the United Kingdom (UK) held a referendum to determine whether the country would “Remain” in the European Union (EU) or “Leave” the EU. This referendum is commonly known as Brexit. Although the media and others interpreted poll results as forecasting “Remain” (<span class="math inline">\(p &gt; 0.5\)</span>), the actual proportion that voted “Remain” was only 48.1% (<span class="math inline">\(p = 0.481\)</span>) and the UK thus voted to leave the EU. Pollsters in the UK were criticized for overestimating support for “Remain”.</p>
<p>In this project, you will analyze real Brexit polling data to develop polling models to forecast Brexit results. You will write your own code in R and enter the answers on the edX platform.</p>
<p><strong>Important definitions</strong></p>
<p><strong><em>Data Import</em></strong></p>
<p>Import the <code>brexit_polls</code> polling data from the <strong>dslabs</strong> package and set options for the analysis:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="section-7-overview.html#cb314-1" aria-hidden="true"></a><span class="co"># suggested options</span></span>
<span id="cb314-2"><a href="section-7-overview.html#cb314-2" aria-hidden="true"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</span>
<span id="cb314-3"><a href="section-7-overview.html#cb314-3" aria-hidden="true"></a></span>
<span id="cb314-4"><a href="section-7-overview.html#cb314-4" aria-hidden="true"></a><span class="co"># load brexit_polls object</span></span>
<span id="cb314-5"><a href="section-7-overview.html#cb314-5" aria-hidden="true"></a><span class="kw">data</span>(brexit_polls)</span></code></pre></div>
<p><strong><em>Final Brexit parameters</em></strong></p>
<p>Define <span class="math inline">\(p = 0.481\)</span> as the actual percent voting “Remain” on the Brexit referendum and <span class="math inline">\(d = 2p - 1 = -0.038\)</span> as the actual spread of the Brexit referendum with “Remain” defined as the positive outcome:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="section-7-overview.html#cb315-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="fl">0.481</span>    <span class="co"># official proportion voting &quot;Remain&quot;</span></span>
<span id="cb315-2"><a href="section-7-overview.html#cb315-2" aria-hidden="true"></a>d &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>p<span class="dv">-1</span>    <span class="co"># official spread</span></span></code></pre></div>
<div id="question-1-the-final-proportion-of-voters-choosing-remain-was-p0.481.-consider-a-poll-with-a-sample-of-n1500-voters." class="section level4" number="8.5.0.1">
<h4><span class="header-section-number">8.5.0.1</span> Question 1: The final proportion of voters choosing “Remain” was p=0.481. Consider a poll with a sample of N=1500 voters.</h4>
<p>What is the expected total number of voters in the sample choosing “Remain”?</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="section-7-overview.html#cb316-1" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="fl">0.481</span></span>
<span id="cb316-2"><a href="section-7-overview.html#cb316-2" aria-hidden="true"></a>N &lt;-<span class="st"> </span><span class="dv">1500</span></span>
<span id="cb316-3"><a href="section-7-overview.html#cb316-3" aria-hidden="true"></a>N<span class="op">*</span>p</span></code></pre></div>
<pre><code>## [1] 722</code></pre>
<p>What is the standard error of the total number of voters in the sample choosing “Remain”?</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="section-7-overview.html#cb318-1" aria-hidden="true"></a><span class="kw">sqrt</span>(N<span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))</span></code></pre></div>
<pre><code>## [1] 19.4</code></pre>
<p>What is the expected value of <span class="math inline">\(\hat{X}\)</span>, the proportion of “Remain” voters?</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="section-7-overview.html#cb320-1" aria-hidden="true"></a>X_hat &lt;-<span class="st"> </span>p</span>
<span id="cb320-2"><a href="section-7-overview.html#cb320-2" aria-hidden="true"></a>X_hat</span></code></pre></div>
<pre><code>## [1] 0.481</code></pre>
<p>What is the standard error of <span class="math inline">\(\hat{X}\)</span>, the proportion of “Remain” voters?</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="section-7-overview.html#cb322-1" aria-hidden="true"></a><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">/</span>N)</span></code></pre></div>
<pre><code>## [1] 0.0129</code></pre>
<p>What is the expected value of <span class="math inline">\(d\)</span>, the spread between the proportion of “Remain” voters and “Leave” voters?</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="section-7-overview.html#cb324-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">*</span>p<span class="dv">-1</span></span></code></pre></div>
<pre><code>## [1] -0.038</code></pre>
<p>What is the standard error of <span class="math inline">\(d\)</span>, the spread between the proportion of “Remain” voters and “Leave” voters?</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="section-7-overview.html#cb326-1" aria-hidden="true"></a><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">/</span>N)</span></code></pre></div>
<pre><code>## [1] 0.0258</code></pre>
</div>
<div id="question-2-load-and-inspect-the-brexit_polls-dataset-from-dslabs-which-contains-actual-polling-data-for-the-6-months-before-the-brexit-vote." class="section level4" number="8.5.0.2">
<h4><span class="header-section-number">8.5.0.2</span> Question 2: Load and inspect the <code>brexit_polls</code> dataset from dslabs, which contains actual polling data for the 6 months before the Brexit vote.</h4>
<p>Raw proportions of voters preferring “Remain”, “Leave”, and “Undecided” are available (<code>remain</code>, <code>leave</code>, <code>undecided</code>) The spread is also available (<code>spread</code>), which is the difference in the raw proportion of voters choosing “Remain” and the raw proportion choosing “Leave”.</p>
<p>Calculate <code>x_hat</code> for each poll, the estimate of the proportion of voters choosing “Remain” on the referendum day (<span class="math inline">\(p = 0.481\)</span>), given the observed <code>spread</code> and the relationship <span class="math inline">\(\hat{d} = 2\hat{X} - 1\)</span>. Use <code>mutate()</code> to add a variable <code>x_hat</code> to the `<code>brexit_polls</code> object by filling in the skeleton code below:</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="section-7-overview.html#cb328-1" aria-hidden="true"></a>brexit_polls &lt;-<span class="st"> </span>brexit_polls <span class="op">%&gt;%</span></span>
<span id="cb328-2"><a href="section-7-overview.html#cb328-2" aria-hidden="true"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">x_hat =</span> __________)</span></code></pre></div>
<p>What is the average of the observed spreads (<code>spread</code>)?</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="section-7-overview.html#cb329-1" aria-hidden="true"></a>brexit_polls &lt;-<span class="st"> </span>brexit_polls <span class="op">%&gt;%</span></span>
<span id="cb329-2"><a href="section-7-overview.html#cb329-2" aria-hidden="true"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">x_hat =</span> (spread<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb329-3"><a href="section-7-overview.html#cb329-3" aria-hidden="true"></a></span>
<span id="cb329-4"><a href="section-7-overview.html#cb329-4" aria-hidden="true"></a><span class="kw">mean</span>(brexit_polls<span class="op">$</span>spread)</span></code></pre></div>
<pre><code>## [1] 0.0201</code></pre>
<p>What is the standard deviation of the observed spreads?</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="section-7-overview.html#cb331-1" aria-hidden="true"></a><span class="kw">sd</span>(brexit_polls<span class="op">$</span>spread)</span></code></pre></div>
<pre><code>## [1] 0.0588</code></pre>
<p>What is the average of <code>x_hat</code>, the estimates of the parameter <span class="math inline">\(p\)</span>?</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="section-7-overview.html#cb333-1" aria-hidden="true"></a><span class="kw">mean</span>(brexit_polls<span class="op">$</span>x_hat)</span></code></pre></div>
<pre><code>## [1] 0.51</code></pre>
<p>What is the standard deviation of <code>x_hat</code>?</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="section-7-overview.html#cb335-1" aria-hidden="true"></a><span class="kw">sd</span>(brexit_polls<span class="op">$</span>x_hat)</span></code></pre></div>
<pre><code>## [1] 0.0294</code></pre>
</div>
<div id="question-3-confidence-interval-of-a-brexit-poll" class="section level4" number="8.5.0.3">
<h4><span class="header-section-number">8.5.0.3</span> Question 3: Confidence interval of a Brexit poll</h4>
<p>Consider the first poll in <code>brexit_polls</code>, a YouGov poll run on the same day as the Brexit referendum:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="section-7-overview.html#cb337-1" aria-hidden="true"></a>brexit_polls[<span class="dv">1</span>,]</span></code></pre></div>
<pre><code>##    startdate    enddate pollster poll_type samplesize remain leave undecided spread x_hat
## 1 2016-06-23 2016-06-23   YouGov    Online       4772   0.52  0.48         0   0.04  0.52</code></pre>
<p>Use <code>qnorm</code> to compute the 95% confidence interval for <span class="math inline">\(\hat{X}\)</span>.</p>
<p>What is the lower bound of the 95% confidence interval?</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="section-7-overview.html#cb339-1" aria-hidden="true"></a>x_hat &lt;-<span class="st"> </span><span class="fl">0.52</span></span>
<span id="cb339-2"><a href="section-7-overview.html#cb339-2" aria-hidden="true"></a>N &lt;-<span class="st"> </span><span class="dv">4772</span></span>
<span id="cb339-3"><a href="section-7-overview.html#cb339-3" aria-hidden="true"></a>se_hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(x_hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x_hat)<span class="op">/</span>N)</span>
<span id="cb339-4"><a href="section-7-overview.html#cb339-4" aria-hidden="true"></a>x_hat <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)<span class="op">*</span>se_hat</span></code></pre></div>
<pre><code>## [1] 0.506</code></pre>
<p>What is the upper bound of the 95% confidence interval?</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="section-7-overview.html#cb341-1" aria-hidden="true"></a>x_hat <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)<span class="op">*</span>se_hat</span></code></pre></div>
<pre><code>## [1] 0.534</code></pre>
<p>Does the 95% confidence interval predict a winner (does not cover <span class="math inline">\(p = 0.5\)</span>)? Does the 95% confidence interval cover the true value of <span class="math inline">\(p\)</span> observed during the referendum?</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="section-7-overview.html#cb343-1" aria-hidden="true"></a><span class="op">!</span><span class="kw">between</span>(<span class="fl">0.5</span>, x_hat <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)<span class="op">*</span>se_hat, x_hat <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)<span class="op">*</span>se_hat)    <span class="co"># predicts winner</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="section-7-overview.html#cb345-1" aria-hidden="true"></a><span class="kw">between</span>(<span class="fl">0.481</span>, x_hat <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)<span class="op">*</span>se_hat, x_hat <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)<span class="op">*</span>se_hat)    <span class="co"># does not cover p</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. The interval predicts a winner and covers the true value of <span class="math inline">\(p\)</span>.</li>
<li><input type="checkbox" disabled="" checked="" />
B. The interval predicts a winner but does not cover the true value of <span class="math inline">\(p\)</span>.</li>
<li><input type="checkbox" disabled="" />
C. The interval does not predict a winner but does cover the true value of <span class="math inline">\(p\)</span>.</li>
<li><input type="checkbox" disabled="" />
D. The interval does not predict a winner and does not cover the true value of <span class="math inline">\(p\)</span>.</li>
</ul>
</div>
</div>
<div id="brexit-poll-analysis---part-2" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Brexit poll analysis - Part 2</h2>
<div id="question-4-create-the-data-frame-june_polls-containing-only-brexit-polls-ending-in-june-2016-enddate-of-2016-06-01-and-later." class="section level4" number="8.6.0.1">
<h4><span class="header-section-number">8.6.0.1</span> Question 4: Create the data frame <code>june_polls</code> containing only Brexit polls ending in June 2016 (<code>enddate</code> of “2016-06-01” and later).</h4>
<p>We will calculate confidence intervals for all polls and determine how many cover the true value of <span class="math inline">\(d\)</span>.</p>
<p>First, use <code>mutate()</code> to calculate a plug-in estimate <code>se_x_hat</code> for the standard error of the estimate <span class="math inline">\(\hat{\mbox{SE}}[X]\)</span> for each poll given its sample size and value of <span class="math inline">\(\hat{X}\)</span> (<code>x_hat</code>). Second, use <code>mutate()</code> to calculate an estimate for the standard error of the spread for each poll given the value of <code>se_x_hat</code>.
Then, use <code>mutate()</code> to calculate upper and lower bounds for 95% confidence intervals of the spread. Last, add a column <code>hit</code> that indicates whether the confidence interval for each poll covers the correct spread <span class="math inline">\(d = -0.038\)</span>.</p>
<p>How many polls are in <code>june_polls</code>?</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="section-7-overview.html#cb347-1" aria-hidden="true"></a>june_polls &lt;-<span class="st"> </span>brexit_polls <span class="op">%&gt;%</span></span>
<span id="cb347-2"><a href="section-7-overview.html#cb347-2" aria-hidden="true"></a><span class="st">              </span><span class="kw">filter</span>(enddate <span class="op">&gt;=</span><span class="st"> &quot;2016-06-01&quot;</span>)</span>
<span id="cb347-3"><a href="section-7-overview.html#cb347-3" aria-hidden="true"></a>    <span class="kw">nrow</span>(june_polls)</span></code></pre></div>
<pre><code>## [1] 32</code></pre>
<p>What proportion of polls have a confidence interval that covers the value 0?</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="section-7-overview.html#cb349-1" aria-hidden="true"></a>june_polls &lt;-<span class="st"> </span>june_polls <span class="op">%&gt;%</span></span>
<span id="cb349-2"><a href="section-7-overview.html#cb349-2" aria-hidden="true"></a><span class="st">              </span><span class="kw">mutate</span>(<span class="dt">se_x_hat =</span> <span class="kw">sqrt</span>(x_hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x_hat)<span class="op">/</span>samplesize),</span>
<span id="cb349-3"><a href="section-7-overview.html#cb349-3" aria-hidden="true"></a>                     <span class="dt">se_spread =</span> <span class="dv">2</span><span class="op">*</span>se_x_hat,</span>
<span id="cb349-4"><a href="section-7-overview.html#cb349-4" aria-hidden="true"></a>                     <span class="dt">ci_lower_spread =</span> spread <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span>se_spread,</span>
<span id="cb349-5"><a href="section-7-overview.html#cb349-5" aria-hidden="true"></a>                     <span class="dt">ci_upper_spread =</span> spread <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span>se_spread)</span>
<span id="cb349-6"><a href="section-7-overview.html#cb349-6" aria-hidden="true"></a>          <span class="kw">mean</span>(june_polls<span class="op">$</span>ci_lower_spread <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>june_polls<span class="op">$</span>ci_upper_spread <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.625</code></pre>
<p>What proportion of polls predict “Remain” (confidence interval entirely above 0)?</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="section-7-overview.html#cb351-1" aria-hidden="true"></a><span class="kw">mean</span>(june_polls<span class="op">$</span>ci_lower_spread <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.125</code></pre>
<p>What proportion of polls have a confidence interval covering the true value of <span class="math inline">\(d\)</span>?</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="section-7-overview.html#cb353-1" aria-hidden="true"></a>june_polls &lt;-<span class="st"> </span>june_polls <span class="op">%&gt;%</span></span>
<span id="cb353-2"><a href="section-7-overview.html#cb353-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">hit =</span> (<span class="dv">2</span><span class="op">*</span>p<span class="dv">-1</span> <span class="op">&gt;</span><span class="st"> </span>ci_lower_spread) <span class="op">&amp;</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>p<span class="dv">-1</span> <span class="op">&lt;</span><span class="st"> </span>ci_upper_spread))</span>
<span id="cb353-3"><a href="section-7-overview.html#cb353-3" aria-hidden="true"></a>    <span class="kw">mean</span>(june_polls<span class="op">$</span>hit)</span></code></pre></div>
<pre><code>## [1] 0.562</code></pre>
</div>
<div id="question-5-group-and-summarize-the-june_polls-object-by-pollster-to-find-the-proportion-of-hits-for-each-pollster-and-the-number-of-polls-per-pollster." class="section level4" number="8.6.0.2">
<h4><span class="header-section-number">8.6.0.2</span> Question 5: Group and summarize the <code>june_polls</code> object by pollster to find the proportion of hits for each pollster and the number of polls per pollster.</h4>
<p>Use <code>arrange()</code> to sort by hit rate.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="section-7-overview.html#cb355-1" aria-hidden="true"></a>june_polls <span class="op">%&gt;%</span></span>
<span id="cb355-2"><a href="section-7-overview.html#cb355-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(pollster) <span class="op">%&gt;%</span></span>
<span id="cb355-3"><a href="section-7-overview.html#cb355-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">hit_rate=</span><span class="kw">mean</span>(hit), <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb355-4"><a href="section-7-overview.html#cb355-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">arrange</span>(hit_rate)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 12 x 3
##    pollster           hit_rate `n()`
##    &lt;fct&gt;                 &lt;dbl&gt; &lt;int&gt;
##  1 BMG Research          0         2
##  2 ORB/Telegraph         0         1
##  3 Populus               0         1
##  4 ComRes                0.333     3
##  5 Ipsos MORI            0.5       2
##  6 Survation             0.5       2
##  7 YouGov                0.556     9
##  8 Opinium               0.667     3
##  9 ORB                   0.667     3
## 10 ICM                   1         3
## 11 Survation/IG Group    1         1
## 12 TNS                   1         2</code></pre>
<p>Which of the following are TRUE?</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. Unbiased polls and pollsters will theoretically cover the correct value of the spread 50% of the time.</li>
<li><input type="checkbox" disabled="" />
B. Only one pollster had a 100% success rate in generating confidence intervals that covered the correct value of the spread.</li>
<li><input type="checkbox" disabled="" />
C. The pollster with the highest number of polls covered the correct value of the spread in their confidence interval over 60% of the time.</li>
<li><input type="checkbox" disabled="" />
D. All pollsters produced confidence intervals covering the correct spread in at least 1 of their polls.</li>
<li><input type="checkbox" disabled="" checked="" />
E. The results are consistent with a large general bias that affects all pollsters.</li>
</ul>
</div>
<div id="question-6-boxplot-of-brexit-polls-by-poll-type" class="section level4" number="8.6.0.3">
<h4><span class="header-section-number">8.6.0.3</span> Question 6: Boxplot of Brexit polls by poll type</h4>
<p>Make a boxplot of the spread in <code>june_polls</code> by poll type.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="section-7-overview.html#cb358-1" aria-hidden="true"></a>june_polls <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(poll_type) <span class="op">%&gt;%</span></span>
<span id="cb358-2"><a href="section-7-overview.html#cb358-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(poll_type,spread)) <span class="op">+</span></span>
<span id="cb358-3"><a href="section-7-overview.html#cb358-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="img/figures/unnamed-chunk-117-1.png" width="672" /></p>
<p>Which of the following are TRUE?</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
A. Online polls tend to show support for “Remain” (spread &gt; 0).</li>
<li><input type="checkbox" disabled="" checked="" />
B. Telephone polls tend to show support “Remain” (spread &gt; 0).</li>
<li><input type="checkbox" disabled="" checked="" />
C. Telephone polls tend to show higher support for “Remain” than online polls (higher spread).</li>
<li><input type="checkbox" disabled="" checked="" />
D. Online polls have a larger interquartile range (IQR) for the spread than telephone polls, indicating that they are more variable.</li>
<li><input type="checkbox" disabled="" checked="" />
E. Poll type introduces a bias that affects poll results.</li>
</ul>
</div>
<div id="question-7-calculate-the-confidence-intervals-of-the-spread-combined-across-all-polls-in-june_polls-grouping-by-poll-type." class="section level4" number="8.6.0.4">
<h4><span class="header-section-number">8.6.0.4</span> Question 7: Calculate the confidence intervals of the spread combined across all polls in <code>june_polls</code>, grouping by poll type.</h4>
<p>Recall that to determine the standard error of the spread, you will need to double the standard error of the estimate.</p>
<p>Use this code (which determines the total sample size per poll type, gives each spread estimate a weight based on the poll’s sample size, and adds an estimate of p from the combined spread) to begin your analysis:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="section-7-overview.html#cb359-1" aria-hidden="true"></a>combined_by_type &lt;-<span class="st"> </span>june_polls <span class="op">%&gt;%</span></span>
<span id="cb359-2"><a href="section-7-overview.html#cb359-2" aria-hidden="true"></a><span class="st">        </span><span class="kw">group_by</span>(poll_type) <span class="op">%&gt;%</span></span>
<span id="cb359-3"><a href="section-7-overview.html#cb359-3" aria-hidden="true"></a><span class="st">        </span><span class="kw">summarize</span>(<span class="dt">N =</span> <span class="kw">sum</span>(samplesize),</span>
<span id="cb359-4"><a href="section-7-overview.html#cb359-4" aria-hidden="true"></a>                  <span class="dt">spread =</span> <span class="kw">sum</span>(spread<span class="op">*</span>samplesize)<span class="op">/</span>N,</span>
<span id="cb359-5"><a href="section-7-overview.html#cb359-5" aria-hidden="true"></a>                  <span class="dt">p_hat =</span> (spread <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<p>#What is the lower bound of the 95% confidence interval for online voters?</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="section-7-overview.html#cb361-1" aria-hidden="true"></a>combined_by_type &lt;-<span class="st"> </span>june_polls <span class="op">%&gt;%</span></span>
<span id="cb361-2"><a href="section-7-overview.html#cb361-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>(poll_type) <span class="op">%&gt;%</span></span>
<span id="cb361-3"><a href="section-7-overview.html#cb361-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">N =</span> <span class="kw">sum</span>(samplesize),</span>
<span id="cb361-4"><a href="section-7-overview.html#cb361-4" aria-hidden="true"></a>              <span class="dt">spread =</span> <span class="kw">sum</span>(spread<span class="op">*</span>samplesize)<span class="op">/</span>N,</span>
<span id="cb361-5"><a href="section-7-overview.html#cb361-5" aria-hidden="true"></a>              <span class="dt">p_hat =</span> (spread <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb361-6"><a href="section-7-overview.html#cb361-6" aria-hidden="true"></a>              <span class="dt">se_spread =</span> <span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(p_hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p_hat)<span class="op">/</span>N),</span>
<span id="cb361-7"><a href="section-7-overview.html#cb361-7" aria-hidden="true"></a>              <span class="dt">spread_lower =</span> spread <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)<span class="op">*</span>se_spread,</span>
<span id="cb361-8"><a href="section-7-overview.html#cb361-8" aria-hidden="true"></a>              <span class="dt">spread_upper =</span> spread <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)<span class="op">*</span>se_spread)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="section-7-overview.html#cb363-1" aria-hidden="true"></a>combined_by_type <span class="op">%&gt;%</span></span>
<span id="cb363-2"><a href="section-7-overview.html#cb363-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(poll_type <span class="op">==</span><span class="st"> &quot;Online&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb363-3"><a href="section-7-overview.html#cb363-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">pull</span>(spread_lower)</span></code></pre></div>
<pre><code>## [1] -0.0165</code></pre>
<p>What is the upper bound of the 95% confidence interval for online voters?</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="section-7-overview.html#cb365-1" aria-hidden="true"></a>combined_by_type <span class="op">%&gt;%</span></span>
<span id="cb365-2"><a href="section-7-overview.html#cb365-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(poll_type <span class="op">==</span><span class="st"> &quot;Online&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb365-3"><a href="section-7-overview.html#cb365-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">pull</span>(spread_upper)</span></code></pre></div>
<pre><code>## [1] 0.00165</code></pre>
</div>
<div id="question-8-interpret-the-confidence-intervals-for-the-combined-spreads-for-each-poll-type-calculated-in-the-previous-problem." class="section level4" number="8.6.0.5">
<h4><span class="header-section-number">8.6.0.5</span> Question 8: Interpret the confidence intervals for the combined spreads for each poll type calculated in the previous problem.</h4>
<p>Which of the following are TRUE about the confidence intervals of the combined spreads for different poll types?</p>
<p>Select ALL correct answers.</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
A. Neither set of combined polls makes a prediction about the outcome of the Brexit referendum (a prediction is possible if a confidence interval does not cover 0).</li>
<li><input type="checkbox" disabled="" />
B. The confidence interval for online polls is larger than the confidence interval for telephone polls.</li>
<li><input type="checkbox" disabled="" checked="" />
C. The confidence interval for telephone polls is covers more positive values than the confidence interval for online polls.</li>
<li><input type="checkbox" disabled="" />
D. The confidence intervals for different poll types do not overlap.</li>
<li><input type="checkbox" disabled="" checked="" />
E. Neither confidence interval covers the true value of 𝑑=−0.038.</li>
</ul>
</div>
</div>
<div id="brexit-poll-analysis---part-3" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> Brexit poll analysis - Part 3</h2>
<div id="question-9-define-brexit_hit-with-the-following-code-which-computes-the-confidence-intervals-for-all-brexit-polls-in-2016-and-then-calculates-whether-the-confidence-interval-covers-the-actual-value-of-the-spread-d--0.038" class="section level4" number="8.7.0.1">
<h4><span class="header-section-number">8.7.0.1</span> Question 9: Define <code>brexit_hit</code>, with the following code, which computes the confidence intervals for all Brexit polls in 2016 and then calculates whether the confidence interval covers the actual value of the spread <span class="math inline">\(d = -0.038\)</span>:</h4>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="section-7-overview.html#cb367-1" aria-hidden="true"></a>brexit_hit &lt;-<span class="st"> </span>brexit_polls <span class="op">%&gt;%</span></span>
<span id="cb367-2"><a href="section-7-overview.html#cb367-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_hat =</span> (spread <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb367-3"><a href="section-7-overview.html#cb367-3" aria-hidden="true"></a>         <span class="dt">se_spread =</span> <span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(p_hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p_hat)<span class="op">/</span>samplesize),</span>
<span id="cb367-4"><a href="section-7-overview.html#cb367-4" aria-hidden="true"></a>         <span class="dt">spread_lower =</span> spread <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)<span class="op">*</span>se_spread,</span>
<span id="cb367-5"><a href="section-7-overview.html#cb367-5" aria-hidden="true"></a>         <span class="dt">spread_upper =</span> spread <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)<span class="op">*</span>se_spread,</span>
<span id="cb367-6"><a href="section-7-overview.html#cb367-6" aria-hidden="true"></a>         <span class="dt">hit =</span> spread_lower <span class="op">&lt;</span><span class="st"> </span>d <span class="op">&amp;</span><span class="st"> </span>spread_upper <span class="op">&gt;</span><span class="st"> </span>d) <span class="op">%&gt;%</span></span>
<span id="cb367-7"><a href="section-7-overview.html#cb367-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(poll_type, hit)</span></code></pre></div>
<p>Use <code>brexit_hit</code> to make a two-by-two table of poll type and hit status.
Then use the <code>chisq.test()</code> function to perform a chi-squared test to determine whether the difference in hit rate is significant.</p>
<p>What is the p-value of the chi-squared test comparing the hit rate of online and telephone polls?</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="section-7-overview.html#cb368-1" aria-hidden="true"></a>brexit_chisq &lt;-<span class="st"> </span><span class="kw">table</span>(brexit_hit<span class="op">$</span>poll_type, brexit_hit<span class="op">$</span>hit)</span>
<span id="cb368-2"><a href="section-7-overview.html#cb368-2" aria-hidden="true"></a><span class="kw">chisq.test</span>(brexit_chisq)<span class="op">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.00101</code></pre>
<p>Determine which poll type has a higher probability of producing a confidence interval that covers the correct value of the spread. Also determine whether this difference is statistically significant at a p-value cutoff of 0.05.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="section-7-overview.html#cb370-1" aria-hidden="true"></a><span class="co"># online &gt; telephone</span></span>
<span id="cb370-2"><a href="section-7-overview.html#cb370-2" aria-hidden="true"></a>hit_rate &lt;-<span class="st"> </span>brexit_hit <span class="op">%&gt;%</span></span>
<span id="cb370-3"><a href="section-7-overview.html#cb370-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>(poll_type) <span class="op">%&gt;%</span></span>
<span id="cb370-4"><a href="section-7-overview.html#cb370-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">avg =</span> <span class="kw">mean</span>(hit))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="section-7-overview.html#cb372-1" aria-hidden="true"></a>hit_rate<span class="op">$</span>avg[hit_rate<span class="op">$</span>poll_type <span class="op">==</span><span class="st"> &quot;Online&quot;</span>] <span class="op">&gt;</span><span class="st"> </span>hit_rate<span class="op">$</span>avg[hit_rate<span class="op">$</span>poll_type <span class="op">==</span><span class="st"> &quot;Telephone&quot;</span>]</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="section-7-overview.html#cb374-1" aria-hidden="true"></a><span class="co"># statistically significant</span></span>
<span id="cb374-2"><a href="section-7-overview.html#cb374-2" aria-hidden="true"></a><span class="kw">chisq.test</span>(brexit_chisq)<span class="op">$</span>p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Which of the following is true?</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
A. Online polls are more likely to cover the correct value of the spread and this difference is statistically significant.</li>
<li><input type="checkbox" disabled="" />
B. Online polls are more likely to cover the correct value of the spread, but this difference is not statistically significant.</li>
<li><input type="checkbox" disabled="" />
C. Telephone polls are more likely to cover the correct value of the spread and this difference is statistically significant.</li>
<li><input type="checkbox" disabled="" />
D. Telephone polls are more likely to cover the correct value of the spread, but this difference is not statistically significant.</li>
</ul>
</div>
<div id="question-10-use-the-two-by-two-table-constructed-in-the-previous-exercise-to-calculate-the-odds-ratio-between-the-hit-rate-of-online-and-telephone-polls-to-determine-the-magnitude-of-the-difference-in-performance-between-the-poll-types." class="section level4" number="8.7.0.2">
<h4><span class="header-section-number">8.7.0.2</span> Question 10: Use the two-by-two table constructed in the previous exercise to calculate the odds ratio between the hit rate of online and telephone polls to determine the magnitude of the difference in performance between the poll types.</h4>
<p>Calculate the odds that an online poll generates a confidence interval that covers the actual value of the spread.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="section-7-overview.html#cb376-1" aria-hidden="true"></a><span class="co"># from previous question</span></span>
<span id="cb376-2"><a href="section-7-overview.html#cb376-2" aria-hidden="true"></a>brexit_chisq &lt;-<span class="st"> </span><span class="kw">table</span>(brexit_hit<span class="op">$</span>poll_type, brexit_hit<span class="op">$</span>hit)</span>
<span id="cb376-3"><a href="section-7-overview.html#cb376-3" aria-hidden="true"></a></span>
<span id="cb376-4"><a href="section-7-overview.html#cb376-4" aria-hidden="true"></a><span class="co"># convert to data frame</span></span>
<span id="cb376-5"><a href="section-7-overview.html#cb376-5" aria-hidden="true"></a>chisq_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(brexit_chisq)</span>
<span id="cb376-6"><a href="section-7-overview.html#cb376-6" aria-hidden="true"></a></span>
<span id="cb376-7"><a href="section-7-overview.html#cb376-7" aria-hidden="true"></a>online_true &lt;-<span class="st"> </span>chisq_df<span class="op">$</span>Freq[chisq_df<span class="op">$</span>Var1 <span class="op">==</span><span class="st"> &quot;Online&quot;</span> <span class="op">&amp;</span><span class="st"> </span>chisq_df<span class="op">$</span>Var2 <span class="op">==</span><span class="st"> &quot;TRUE&quot;</span>]</span>
<span id="cb376-8"><a href="section-7-overview.html#cb376-8" aria-hidden="true"></a>online_false &lt;-<span class="st"> </span>chisq_df<span class="op">$</span>Freq[chisq_df<span class="op">$</span>Var1 <span class="op">==</span><span class="st"> &quot;Online&quot;</span> <span class="op">&amp;</span><span class="st"> </span>chisq_df<span class="op">$</span>Var2 <span class="op">==</span><span class="st"> &quot;FALSE&quot;</span>]</span>
<span id="cb376-9"><a href="section-7-overview.html#cb376-9" aria-hidden="true"></a></span>
<span id="cb376-10"><a href="section-7-overview.html#cb376-10" aria-hidden="true"></a>online_odds &lt;-<span class="st"> </span>online_true<span class="op">/</span>online_false</span>
<span id="cb376-11"><a href="section-7-overview.html#cb376-11" aria-hidden="true"></a>online_odds</span></code></pre></div>
<pre><code>## [1] 1.3</code></pre>
<p>Calculate the odds that a telephone poll generates a confidence interval that covers the actual value of the spread.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="section-7-overview.html#cb378-1" aria-hidden="true"></a>phone_true &lt;-<span class="st"> </span>chisq_df<span class="op">$</span>Freq[chisq_df<span class="op">$</span>Var1 <span class="op">==</span><span class="st"> &quot;Telephone&quot;</span> <span class="op">&amp;</span><span class="st"> </span>chisq_df<span class="op">$</span>Var2 <span class="op">==</span><span class="st"> &quot;TRUE&quot;</span>]</span>
<span id="cb378-2"><a href="section-7-overview.html#cb378-2" aria-hidden="true"></a>phone_false &lt;-<span class="st"> </span>chisq_df<span class="op">$</span>Freq[chisq_df<span class="op">$</span>Var1 <span class="op">==</span><span class="st"> &quot;Telephone&quot;</span> <span class="op">&amp;</span><span class="st"> </span>chisq_df<span class="op">$</span>Var2 <span class="op">==</span><span class="st"> &quot;FALSE&quot;</span>]</span>
<span id="cb378-3"><a href="section-7-overview.html#cb378-3" aria-hidden="true"></a></span>
<span id="cb378-4"><a href="section-7-overview.html#cb378-4" aria-hidden="true"></a>phone_odds &lt;-<span class="st"> </span>phone_true<span class="op">/</span>phone_false</span>
<span id="cb378-5"><a href="section-7-overview.html#cb378-5" aria-hidden="true"></a>phone_odds</span></code></pre></div>
<pre><code>## [1] 0.312</code></pre>
<p>Calculate the odds ratio to determine how many times larger the odds are for online polls to hit versus telephone polls.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="section-7-overview.html#cb380-1" aria-hidden="true"></a>online_odds<span class="op">/</span>phone_odds</span></code></pre></div>
<pre><code>## [1] 4.15</code></pre>
</div>
<div id="question-11-use-brexit_polls-to-make-a-plot-of-the-spread-spread-over-time-enddate-colored-by-poll-type-poll_type." class="section level4" number="8.7.0.3">
<h4><span class="header-section-number">8.7.0.3</span> Question 11: Use <code>brexit_polls</code> to make a plot of the spread (<code>spread</code>) over time (<code>enddate</code>) colored by poll type (<code>poll_type</code>).</h4>
<p>Use <code>geom_smooth()</code> with <code>method = "loess"</code> to plot smooth curves with a span of 0.4. Include the individual data points colored by poll type. Add a horizontal line indicating the final value of <span class="math inline">\(d = -.038\)</span>.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="section-7-overview.html#cb382-1" aria-hidden="true"></a>brexit_polls <span class="op">%&gt;%</span></span>
<span id="cb382-2"><a href="section-7-overview.html#cb382-2" aria-hidden="true"></a><span class="st">              </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(enddate, spread, <span class="dt">color =</span> poll_type)) <span class="op">+</span></span>
<span id="cb382-3"><a href="section-7-overview.html#cb382-3" aria-hidden="true"></a><span class="st">              </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">span =</span> <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb382-4"><a href="section-7-overview.html#cb382-4" aria-hidden="true"></a><span class="st">              </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb382-5"><a href="section-7-overview.html#cb382-5" aria-hidden="true"></a><span class="st">              </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="fl">-.038</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="img/figures/unnamed-chunk-127-1.png" width="672" /></p>
<p>Which of the following plots is correct?</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
B.</li>
</ul>
<div class="figure">
<img src="images/plotting_spread_over_time_option_b.png" alt="" />
<p class="caption">Plotting spread over time</p>
</div>
</div>
<div id="question-12-use-the-following-code-to-create-the-object-brexit_long-which-has-a-column-vote-containing-the-three-possible-votes-on-a-brexit-poll-remain-leave-undecided-and-a-column-proportion-containing-the-raw-proportion-choosing-that-vote-option-on-the-given-poll" class="section level4" number="8.7.0.4">
<h4><span class="header-section-number">8.7.0.4</span> Question 12: Use the following code to create the object <code>brexit_long</code>, which has a column <code>vote</code> containing the three possible votes on a Brexit poll (“remain”, “leave”, “undecided”) and a column <code>proportion</code> containing the raw proportion choosing that vote option on the given poll:</h4>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="section-7-overview.html#cb384-1" aria-hidden="true"></a>brexit_long &lt;-<span class="st"> </span>brexit_polls <span class="op">%&gt;%</span></span>
<span id="cb384-2"><a href="section-7-overview.html#cb384-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">gather</span>(vote, proportion, <span class="st">&quot;remain&quot;</span><span class="op">:</span><span class="st">&quot;undecided&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb384-3"><a href="section-7-overview.html#cb384-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">vote =</span> <span class="kw">factor</span>(vote))</span></code></pre></div>
<p>Make a graph of proportion over time colored by vote. Add a smooth trendline with <code>geom_smooth()</code> and <code>method = "loess"</code> with a span of 0.3.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="section-7-overview.html#cb385-1" aria-hidden="true"></a>brexit_long <span class="op">%&gt;%</span></span>
<span id="cb385-2"><a href="section-7-overview.html#cb385-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(enddate, proportion, <span class="dt">col=</span>vote)) <span class="op">+</span></span>
<span id="cb385-3"><a href="section-7-overview.html#cb385-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb385-4"><a href="section-7-overview.html#cb385-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">span=</span><span class="fl">0.3</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="img/figures/unnamed-chunk-129-1.png" width="672" /></p>
<p>Which of the following are TRUE?</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="" />
A. The percentage of undecided voters declines over time but is still around 10% throughout June.</li>
<li><input type="checkbox" disabled="" checked="" />
B. Over most of the date range, the confidence bands for “Leave” and “Remain” overlap.</li>
<li><input type="checkbox" disabled="" checked="" />
C. Over most of the date range, the confidence bands for “Leave” and “Remain” are below 50%.</li>
<li><input type="checkbox" disabled="" checked="" />
D. In the first half of June, “Leave” was polling higher than “Remain”, although this difference was within the confidence intervals.</li>
<li><input type="checkbox" disabled="" />
E. At the time of the election in late June, the percentage voting “Leave” is trending upwards.</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-6-overview.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
